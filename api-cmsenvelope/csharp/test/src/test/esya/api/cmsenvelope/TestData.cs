using System;
using System.IO;
using tr.gov.tubitak.uekae.esya.api.asn.x509;
using tr.gov.tubitak.uekae.esya.api.cmsenvelope;
using tr.gov.tubitak.uekae.esya.api.common.util;
using tr.gov.tubitak.uekae.esya.api.crypto;
using tr.gov.tubitak.uekae.esya.api.crypto.alg;
using tr.gov.tubitak.uekae.esya.api.crypto.provider.core.baseTypes;

namespace test.esya.api.cmsenvelope
{
    public class TestData
    {
        public static String plainString = "This is a secret message..!";

        public static readonly String plainDataFileName = "T:\\api-cmsenvelope\\testdata\\cmsenvelope\\test.txt";
        public static FileInfo plainFile = new FileInfo(plainDataFileName);

        public static String EncryptionPolicyFile = "T:\\api-parent\\resources\\sample-policy\\certval-encrytion-ug-policy.xml";

        public static KeyPair originalKeyPair;
        public static ECertificate originalCert;

        public static KeyPair recipientKeyPair;
        public static ECertificate recipientCert;

        public static KeyPair recipientEcKeyPair;
        public static ECertificate recipientEcCert;

        public static bool SKIP_CERT_VALIDATION = true;
        public static EnvelopeConfig ENVELOPE_CONFIG;


        static TestData()
        {
            try
            {
                Crypto.setProvider(Crypto.PROVIDER_BOUNCY);

                byte[] data = null;
                IPrivateKey privKey = null;
                IPublicKey publicKey = null;

                data = StringUtil.ToByteArray("30820276020100300D06092A864886F70D0101010500048202603082025C020100028181008A389019F44120DED15571FDE580DA2A9B3DD911B6E765BAF01F1504FD346981B86920040B0DA408229824B23B425A6E156CBCE2F7EFA7A8166914C02FBF84D7EA046652DF413A7ECEBD579697E8731671FAB6185926D9BF792C6087787D939B0034A89598412BB5ADA3FC2069D55F047F4B8C3A1DFCDF87F031F82366E645D502030100010281803A43C1AACF25AD1F800A8EB4C24BE0AB592967196A8A7C7DA2BED77374F0E510C395BCE3376D9699BF4B771C929253E057B3B0A3D473F7AE8953DE656D3B4459C931C314D4E6B6AD717BEF201504724400F86FA3A2286D4ECD2D5F4D015E029BDCCF9898629D1823B545DDF35B81F4D15CD5E7A4D21FFF3A59009DF1F99D5F41024100C029A10EC4CBC4C9E502CDA329969A68E0CB2C0FF25E533AB8546A6F73FF1A655F06D53F5CF8E05424CE8083958D3DFED8F8EED975A328160F3658023DF9C3FD024100B8237E17C0DF8C50D9B4026F7DC584E7496BBAC650520759B6ED3BAA08F37E23F9081DA7C907967D278E86B3E3BEAEEB47B2DA831835ACE56E7E762A2BCD74B902407E0D50B70D64D56BD2ABEA14B3BD3500C324C37C9A72418A6D4C029DA5AB9BB70F84BDF1D89CF11A81226CAEE435488B99EC81516897643E443053BEF4C49849024100860386D4A0D1D1DC51E559D46CD3E13B374B497EE59C1DAF649BD9CD91802D30DF20D1FC7829A693E5C32C34262F743CD64CCC0D970411965549829484969E390240338DEEC8552EDDF593E17D185C803AC67542AA4BFEA0B0B4E2A0303FA909F859781326A21F7BFC9D2BC10478CEB874D018D666A1ABBD08795ADB6431D6972CFC");
                privKey = new PrivateKey(data);
                data = StringUtil.ToByteArray("30819F300D06092A864886F70D010101050003818D00308189028181008A389019F44120DED15571FDE580DA2A9B3DD911B6E765BAF01F1504FD346981B86920040B0DA408229824B23B425A6E156CBCE2F7EFA7A8166914C02FBF84D7EA046652DF413A7ECEBD579697E8731671FAB6185926D9BF792C6087787D939B0034A89598412BB5ADA3FC2069D55F047F4B8C3A1DFCDF87F031F82366E645D50203010001");
                publicKey = new PublicKey(data);
                originalKeyPair = new KeyPair(publicKey, privKey);
                data = StringUtil.ToByteArray("3082021730820180A003020102020102300D06092A864886F70D0101050500301B310C300A060355040A0C034D4133310B3009060355040613025452301E170D3130303830343133323435385A170D3130313131323133323435385A3039310C300A06035504030C03426F62310E300C060355040B0C0553616C6573310C300A060355040A0C034D4133310B300906035504061302545230819F300D06092A864886F70D010101050003818D00308189028181008A389019F44120DED15571FDE580DA2A9B3DD911B6E765BAF01F1504FD346981B86920040B0DA408229824B23B425A6E156CBCE2F7EFA7A8166914C02FBF84D7EA046652DF413A7ECEBD579697E8731671FAB6185926D9BF792C6087787D939B0034A89598412BB5ADA3FC2069D55F047F4B8C3A1DFCDF87F031F82366E645D50203010001A34D304B301D0603551D0E0416041445365586281F82499D44389907D54A469C82C96F301F0603551D2304183016801468BFEAC7BC545A8C57F545D9F1363456CE8B3FC430090603551D1304023000300D06092A864886F70D0101050500038181007935C3AC30ECA9702E5D36E298F33630D856119778B04B585CE08942D097AB7B268B2EEDA5A55C889F966364A165D736584AA6211C6321DEAA78338114A35144D251F199CF78DB543887C97E21479E8E3A1425AF50117ED8B72769B138BA8F2037170850BF4AA6A0EA41A5569BEA07994C686377043543747F25C0F87C8D55D6");
                originalCert = new ECertificate(data);

                data = StringUtil.ToByteArray("30820277020100300D06092A864886F70D0101010500048202613082025D02010002818100AB2765E46F4003E14EE352A2C53E407DB8044CADDE0E6FAB18D3C9243CE77169FCBCEF6531448EF8E3373A0A8DB6031E3710596A7E834FE626127936AE08BE1FD3B81945823334C0C578E22CEA442A5532B44EA2EE003D3BD9F42AC891BE6A54668B93898F9CD97252396BF59067D363DDA10096EBB0EED8402903A6B0C9C78F02030100010281801D9D77980B57FC53E41E9991E8A758E96809F66AAF5DB81CD6F2EE7F02BAD979096E77CDFEB46A38CEB823A6E7D672BBABB37C855CD6C3E082FDF7536AD1C073E06E1A4CBE785D1F1E20195728218081C6144BF1FA8E7986973A91C323E70CD9CDBA7B055523E119775BA6E1190309AA76C3F805F71CB8194FE4F8647BC71C01024100EBD3905CBFA83594F3355DDE9E7C9B5D4020405AA56FAA2BF853D913D0398E6FCEF48284E588F0AC6B46B285CEDB53E8DE777EC039105CB6F03C85BE1637BD0F024100B9CB8CE88FDC186064912FCD508CF0823A8024E57060715B2CA3A34C6C0BBFF8949A923DD20DA0C61289A7B88A4842DAF9C78F28CCC0EA7CE05A1BFDA3CA4D81024003251D25BF8094C659BFFA727F9695D3D68917929DE63154C8C9057A182ACC557D63116288551D308F75AFE7CCEC6BE00D2776CF45738C68FC273279687E71CD0241008F3E06BA3A478727B20159A86284F6DC807BD1766F287BDCBE52BF10A97079A60DF409F1CDA3A22373A15B84E46007E34995F8A28D11E2F73A055EF533354281024100C669F9CD6A76A1EF7D4F8648C7F484F758011FD78734ADC3FF96920EEE21FD12B2F42DCAA658068EF594F4FFDCAF02DBB213FFE435CEEE9BD2046FB4EC243B61");
                privKey = new PrivateKey(data);
                data = StringUtil.ToByteArray("30819F300D06092A864886F70D010101050003818D0030818902818100AB2765E46F4003E14EE352A2C53E407DB8044CADDE0E6FAB18D3C9243CE77169FCBCEF6531448EF8E3373A0A8DB6031E3710596A7E834FE626127936AE08BE1FD3B81945823334C0C578E22CEA442A5532B44EA2EE003D3BD9F42AC891BE6A54668B93898F9CD97252396BF59067D363DDA10096EBB0EED8402903A6B0C9C78F0203010001");
                publicKey = new PublicKey(data);
                recipientKeyPair = new KeyPair(publicKey, privKey);
                data = StringUtil.ToByteArray("3082021830820181A003020102020103300D06092A864886F70D0101050500301B310C300A060355040A0C034D4133310B3009060355040613025452301E170D3130303830343133323435385A170D3130313131323133323435385A303A310D300B06035504030C04446F7567310E300C060355040B0C0553616C6573310C300A060355040A0C034D4133310B300906035504061302545230819F300D06092A864886F70D010101050003818D0030818902818100AB2765E46F4003E14EE352A2C53E407DB8044CADDE0E6FAB18D3C9243CE77169FCBCEF6531448EF8E3373A0A8DB6031E3710596A7E834FE626127936AE08BE1FD3B81945823334C0C578E22CEA442A5532B44EA2EE003D3BD9F42AC891BE6A54668B93898F9CD97252396BF59067D363DDA10096EBB0EED8402903A6B0C9C78F0203010001A34D304B301D0603551D0E04160414245EA8133692A63A31C6714F34692709DA8C48BC301F0603551D2304183016801468BFEAC7BC545A8C57F545D9F1363456CE8B3FC430090603551D1304023000300D06092A864886F70D0101050500038181009484AAA661A5E4557935C8D7F8F5B5EAA72BA8CAD0E1EC3D4CC2A241C2BB65FD6C1695ACF6AE14D0C7159B80631C5638C4D3D125F75DBF281D9B9956ACA4A3E8D015587F812AC874F51D07CB6246C0AE7D6422E0011EF8E68DC4587C234E4D92E90074E75979A908EA9DFD92BB684CBE64E0B928C2BADA33D22B4FCC104D6C72");
                recipientCert = new ECertificate(data);

                data = StringUtil.ToByteArray("30818D020100301306072A8648CE3D020106082A8648CE3D03010404733071020101041E0D65A6A2CE24271CE462F2C529435173A37F7418F87A2B057DD29489E62CA00A06082A8648CE3D030104A140033E00043FCE9567693F4AF47E7221605354C4CB0497C38A10376DD3D402D4752934470B0B23E85E61C9AB5581EAF99068125EFFE8F708B2F466681FE2B58B43");
                privKey = Crypto.getKeyFactory().decodePrivateKey(AsymmetricAlg.ECDSA, data);
                data = StringUtil.ToByteArray("3055301306072A8648CE3D020106082A8648CE3D030104033E00043FCE9567693F4AF47E7221605354C4CB0497C38A10376DD3D402D4752934470B0B23E85E61C9AB5581EAF99068125EFFE8F708B2F466681FE2B58B43");
                publicKey = Crypto.getKeyFactory().decodePublicKey(AsymmetricAlg.ECDSA, data);
                recipientEcKeyPair = new KeyPair(publicKey, privKey);

                data = StringUtil.ToByteArray("308201CD30820136A003020102020104300D06092A864886F70D0101050500301B310C300A060355040A0C034D4133310B3009060355040613025452301E170D3130303830343133323435385A170D3130313131323133323435385A303A310D300B06035504030C04446F7567310E300C060355040B0C0553616C6573310C300A060355040A0C034D4133310B30090603550406130254523055301306072A8648CE3D020106082A8648CE3D030104033E00043FCE9567693F4AF47E7221605354C4CB0497C38A10376DD3D402D4752934470B0B23E85E61C9AB5581EAF99068125EFFE8F708B2F466681FE2B58B43A34D304B301D0603551D0E04160414AA510FFB221920A0A74316D5B57581D2AC1F83ED301F0603551D2304183016801468BFEAC7BC545A8C57F545D9F1363456CE8B3FC430090603551D1304023000300D06092A864886F70D01010505000381810053F78C8E9297B8DEB00DC421FA1BF25A39BE545AE9461488DE1D9C2965E247ADE1E5B82CE7925E0A084ADC6DE9FE962850F1763D991FB8A44CCF1C256A0D10ADF91DCA158E491C369D4E6804ACD9BF7DED94173BA06FEF9BF6C7FFA2F8E84F97B13ACE737ED00C9C5E27B6E30B9BB940671C6D0F0D6AA99608A47C82059FF2E7");
                recipientEcCert = new ECertificate(data);

                ENVELOPE_CONFIG = new EnvelopeConfig();
                if(SKIP_CERT_VALIDATION == true)
                    ENVELOPE_CONFIG.skipCertificateValidation();
            }
            catch (Exception e)
            {
                //e.printStackTrace();
                Console.WriteLine(e.Message);
            }
        }

        public static void configureCertificateValidation(EnvelopeConfig config)
        {
            if (SKIP_CERT_VALIDATION == true)
                config.skipCertificateValidation();
            else
                config.activateCertificateValidation();
        }
    }
}
